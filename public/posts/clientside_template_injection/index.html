<!DOCTYPE html>
<html lang="en-us">
<head>
  <link rel="preload" href="https://yashwanth164.github.io/blog.v3loz1ty/lib/font-awesome/webfonts/fa-brands-400.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="https://yashwanth164.github.io/blog.v3loz1ty/lib/font-awesome/webfonts/fa-regular-400.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="https://yashwanth164.github.io/blog.v3loz1ty/lib/font-awesome/webfonts/fa-solid-900.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="https://yashwanth164.github.io/blog.v3loz1ty/lib/JetBrainsMono/web/woff2/JetBrainsMono-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title> Client Side Template Injection (CSTI) | Velocity Blog</title>
  <link rel = 'canonical' href = 'https://yashwanth164.github.io/blog.v3loz1ty/posts/clientside_template_injection/'>
  <meta name="description" content="This blog site focuses on application security, secure development, and client-side security. Explore best practices, insights on securing web applications, preventing client-side attacks, and building secure software solutions. In addition to these, you will find blogs related to genereal cybersecurity concepts.">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="robots" content="all,follow">
  <meta name="googlebot" content="index,follow,snippet,archive">
  <meta property="og:url" content="https://yashwanth164.github.io/blog.v3loz1ty/posts/clientside_template_injection/">
  <meta property="og:site_name" content="Velocity Blog">
  <meta property="og:title" content="Client Side Template Injection (CSTI)">
  <meta property="og:description" content="Introduction Template injection is a critical web security vulnerability that occurs when user input is embedded into a template in an unsafe manner. This vulnerability allows attackers to inject malicious template code that can lead to remote code execution, data theft, or server compromise. Template injection can occur on both client-side and server-side. This blog focuses on client-side template injection in AngularJS framework which leads to XSS attacks.
Developed by Google, AngularJS serves as a powerful frontend framework for building dynamic web applications. The framework’s template injection vulnerability has gained significant attention in the security community, particularly due to the groundbreaking sandbox escape techniques discovered by Gareth Heyes and Mario Heiderich from Cure53. For a deeper dive into their research on AngularJS sandbox escaping, refer to this comprehensive PortSwigger blog.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-06-04T19:09:43+01:00">
    <meta property="article:modified_time" content="2025-06-04T19:09:43+01:00">
    <meta property="article:tag" content="WebApp">
    <meta property="article:tag" content="Web-Client">

  
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Client Side Template Injection (CSTI)">
  <meta name="twitter:description" content="Introduction Template injection is a critical web security vulnerability that occurs when user input is embedded into a template in an unsafe manner. This vulnerability allows attackers to inject malicious template code that can lead to remote code execution, data theft, or server compromise. Template injection can occur on both client-side and server-side. This blog focuses on client-side template injection in AngularJS framework which leads to XSS attacks.
Developed by Google, AngularJS serves as a powerful frontend framework for building dynamic web applications. The framework’s template injection vulnerability has gained significant attention in the security community, particularly due to the groundbreaking sandbox escape techniques discovered by Gareth Heyes and Mario Heiderich from Cure53. For a deeper dive into their research on AngularJS sandbox escaping, refer to this comprehensive PortSwigger blog.">

  
  
    
  
  
  <link rel="stylesheet" href="https://yashwanth164.github.io/blog.v3loz1ty/css/styles.c05d68261bf086a9d7713c4f8a6215a3601608e267a816a7ee58f139b3d1aae51222aae2081c8e0c6bd35e1334773b7a16283022f31f92afd93bb37e5e822e66.css" integrity="sha512-wF1oJhvwhqnXcTxPimIVo2AWCOJnqBan7ljxObPRquUSIqriCByODGvTXhM0dzt6FigwIvMfkq/ZO7N&#43;XoIuZg=="> 

  
   <link rel="stylesheet" href="https://yashwanth164.github.io/blog.v3loz1ty/css/custom.css"> 
  
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  

  
<link rel="icon" type="image/png" href="https://yashwanth164.github.io/blog.v3loz1ty/images/favicon.ico" />

  
  
</head>
<body class="max-width mx-auto px3 ltr">
  <div class="content index py4">

  <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;" aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
        <li><a href="https://yashwanth164.github.io/blog.v3loz1ty/">Home</a></li>
         
        <li><a href="https://yashwanth164.github.io/blog.v3loz1ty/posts">All posts</a></li>
         
        <li><a href="https://yashwanth164.github.io/blog.v3loz1ty/about">About</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li>
          <a class="icon" href=" https://yashwanth164.github.io/blog.v3loz1ty/posts/jsonp_csp_bypass/" aria-label="Previous">
            <i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i>
          </a>
        </li>
        
        
        <li>
          <a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" aria-label="Top of Page">
            <i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i>
          </a>
        </li>
        <li>
          <a class="icon" href="#" aria-label="Share">
            <i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i>
          </a>
        </li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      
      <ul>
  
  
    
  
  
  <li>
    <a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fyashwanth164.github.io%2fblog.v3loz1ty%2fposts%2fclientside_template_injection%2f" aria-label="Facebook">
      <i class="fab fa-facebook " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://twitter.com/share?url=https%3a%2f%2fyashwanth164.github.io%2fblog.v3loz1ty%2fposts%2fclientside_template_injection%2f&text=Client%20Side%20Template%20Injection%20%28CSTI%29" aria-label="Twitter">
      <i class="fab fa-twitter " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fyashwanth164.github.io%2fblog.v3loz1ty%2fposts%2fclientside_template_injection%2f&title=Client%20Side%20Template%20Injection%20%28CSTI%29" aria-label="Linkedin">
      <i class="fab fa-linkedin " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fyashwanth164.github.io%2fblog.v3loz1ty%2fposts%2fclientside_template_injection%2f&is_video=false&description=Client%20Side%20Template%20Injection%20%28CSTI%29" aria-label="Pinterest">
      <i class="fab fa-pinterest " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="mailto:?subject=Client%20Side%20Template%20Injection%20%28CSTI%29&body=Check out this article: https%3a%2f%2fyashwanth164.github.io%2fblog.v3loz1ty%2fposts%2fclientside_template_injection%2f" aria-label="Email">
      <i class="fas fa-envelope " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2fyashwanth164.github.io%2fblog.v3loz1ty%2fposts%2fclientside_template_injection%2f&title=Client%20Side%20Template%20Injection%20%28CSTI%29" aria-label="Pocket">
      <i class="fab fa-get-pocket " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2fyashwanth164.github.io%2fblog.v3loz1ty%2fposts%2fclientside_template_injection%2f&title=Client%20Side%20Template%20Injection%20%28CSTI%29" aria-label="reddit">
      <i class="fab fa-reddit " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.tumblr.com/share/link?url=https%3a%2f%2fyashwanth164.github.io%2fblog.v3loz1ty%2fposts%2fclientside_template_injection%2f&name=Client%20Side%20Template%20Injection%20%28CSTI%29&description=%3ch1%20id%3d%22introduction%22%3eIntroduction%3c%2fh1%3e%0a%3cp%3eTemplate%20injection%20is%20a%20critical%20web%20security%20vulnerability%20that%20occurs%20when%20user%20input%20is%20embedded%20into%20a%20template%20in%20an%20unsafe%20manner.%20This%20vulnerability%20allows%20attackers%20to%20inject%20malicious%20template%20code%20that%20can%20lead%20to%20remote%20code%20execution%2c%20data%20theft%2c%20or%20server%20compromise.%20Template%20injection%20can%20occur%20on%20both%20client-side%20and%20server-side.%20This%20blog%20focuses%20on%20client-side%20template%20injection%20in%20AngularJS%20framework%20which%20leads%20to%20XSS%20attacks.%3c%2fp%3e%0a%3cp%3eDeveloped%20by%20Google%2c%20AngularJS%20serves%20as%20a%20powerful%20frontend%20framework%20for%20building%20dynamic%20web%20applications.%20The%20framework%26rsquo%3bs%20template%20injection%20vulnerability%20has%20gained%20significant%20attention%20in%20the%20security%20community%2c%20particularly%20due%20to%20the%20groundbreaking%20sandbox%20escape%20techniques%20discovered%20by%20%3ca%20href%3d%22https%3a%2f%2fx.com%2fgarethheyes%22%3eGareth%20Heyes%3c%2fa%3e%20and%20Mario%20Heiderich%20from%20Cure53.%20For%20a%20deeper%20dive%20into%20their%20research%20on%20AngularJS%20sandbox%20escaping%2c%20refer%20to%20this%20comprehensive%20%3ca%20href%3d%22https%3a%2f%2fportswigger.net%2fresearch%2fxss-without-html-client-side-template-injection-with-angularjs%22%3ePortSwigger%20blog%3c%2fa%3e.%3c%2fp%3e" aria-label="Tumblr">
      <i class="fab fa-tumblr " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fyashwanth164.github.io%2fblog.v3loz1ty%2fposts%2fclientside_template_injection%2f&t=Client%20Side%20Template%20Injection%20%28CSTI%29" aria-label="Hacker News">
      <i class="fab fa-hacker-news " aria-hidden="true"></i>
    </a>
  </li>
</ul>

    </div>
    
    <div id="toc">
      <nav id="TableOfContents">
  <ul>
    <li><a href="#introduction">Introduction</a></li>
    <li><a href="#understanding-the-scope-object">Understanding the $scope Object</a></li>
    <li><a href="#sandbox-escaping-mechanisms">Sandbox Escaping Mechanisms</a></li>
  </ul>
</nav>
    </div>
    
  </span>
</div>


  <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
    <header>
      <h1 class="posttitle" itemprop="name headline">
        Client Side Template Injection (CSTI)
      </h1>
      <div class="meta">
        
        <div class="postdate">
          
          <time datetime="2025-06-04 19:09:43 &#43;0100 BST" itemprop="datePublished">2025-06-04</time>
          
        </div>
        
        
        
        
        <div class="article-tag">
            <i class="fas fa-tag"></i>
            
            
            <a class="tag-link" href="https://yashwanth164.github.io/blog.v3loz1ty/tags/webapp" rel="tag">WebApp</a>
            
             ,  
            <a class="tag-link" href="https://yashwanth164.github.io/blog.v3loz1ty/tags/web-client" rel="tag">Web-Client</a>
            
        </div>
        
      </div>
    </header>

  
    
    <div class="content" itemprop="articleBody">
      <h1 id="introduction">Introduction</h1>
<p>Template injection is a critical web security vulnerability that occurs when user input is embedded into a template in an unsafe manner. This vulnerability allows attackers to inject malicious template code that can lead to remote code execution, data theft, or server compromise. Template injection can occur on both client-side and server-side. This blog focuses on client-side template injection in AngularJS framework which leads to XSS attacks.</p>
<p>Developed by Google, AngularJS serves as a powerful frontend framework for building dynamic web applications. The framework&rsquo;s template injection vulnerability has gained significant attention in the security community, particularly due to the groundbreaking sandbox escape techniques discovered by <a href="https://x.com/garethheyes">Gareth Heyes</a> and Mario Heiderich from Cure53. For a deeper dive into their research on AngularJS sandbox escaping, refer to this comprehensive <a href="https://portswigger.net/research/xss-without-html-client-side-template-injection-with-angularjs">PortSwigger blog</a>.</p>
<p>At its core, AngularJS templates extend standard HTML with additional markup, including ng-directives (such as ng-model, ng-bind, ng-app) and the distinctive double curly braces <code>{{}}</code> for interpolation.</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:1;-o-tab-size:1;tab-size:1;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:1;-o-tab-size:1;tab-size:1;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:1;-o-tab-size:1;tab-size:1;"><code class="language-html" data-lang="html"><span style="display:flex;"><span><span style="color:#75715e">&lt;!DOCTYPE html&gt;</span>
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">html</span> <span style="color:#a6e22e">ng-app</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;myApp&#34;</span>&gt;
</span></span><span style="display:flex;"><span>  &lt;<span style="color:#f92672">head</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">script</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;https://ajax.googleapis.com/ajax/libs/angularjs/1.6.9/angular.min.js&#34;</span>&gt;&lt;/<span style="color:#f92672">script</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">script</span>&gt;
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">angular</span>.<span style="color:#a6e22e">module</span>(<span style="color:#e6db74">&#34;myApp&#34;</span>, []);
</span></span><span style="display:flex;"><span>    &lt;/<span style="color:#f92672">script</span>&gt;
</span></span><span style="display:flex;"><span>  &lt;/<span style="color:#f92672">head</span>&gt;
</span></span><span style="display:flex;"><span>  &lt;<span style="color:#f92672">body</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">h3</span>&gt;Testing AngularJS&lt;/<span style="color:#f92672">h3</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">p</span>&gt;{{2+2}}&lt;/<span style="color:#f92672">p</span>&gt;
</span></span><span style="display:flex;"><span>  &lt;/<span style="color:#f92672">body</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">html</span>&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p>In this AngularJS template example, I utilize double curly braces <code>{{}}</code> to evaluate an expression. The statement <code>{{2+2}}</code> is processed by Angular&rsquo;s template engine and rendered as <code>4</code> in the browser, as demonstrated below.</p>
<img src="https://yashwanth164.github.io/blog.v3loz1ty/img/csti1.png" width="700" height="700" alt="Alt text" class="rounded-image">
<p>You might be thinking that <code>{{alert(1)}}</code> can invoke an XSS attack, but that&rsquo;s not the case. This is because of the <code>$scope</code> object.</p>
<h1 id="understanding-the-scope-object">Understanding the $scope Object</h1>
<p>The <code>$scope</code> object in AngularJS serves as a crucial data container, holding both variables and functions that are accessible within the AngularJS template.</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:1;-o-tab-size:1;tab-size:1;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:1;-o-tab-size:1;tab-size:1;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:1;-o-tab-size:1;tab-size:1;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#f92672">&lt;!</span><span style="color:#a6e22e">DOCTYPE</span> <span style="color:#a6e22e">html</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;</span><span style="color:#a6e22e">html</span> <span style="color:#a6e22e">ng</span><span style="color:#f92672">-</span><span style="color:#a6e22e">app</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;myApp&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;</span><span style="color:#a6e22e">head</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">script</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;https://ajax.googleapis.com/ajax/libs/angularjs/1.6.9/angular.min.js&#34;</span><span style="color:#f92672">&gt;&lt;</span><span style="color:#960050;background-color:#1e0010">/script&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">/head&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;</span><span style="color:#a6e22e">body</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">div</span> <span style="color:#a6e22e">ng</span><span style="color:#f92672">-</span><span style="color:#a6e22e">controller</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;GreetingController&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>    {{ <span style="color:#a6e22e">greeting</span> }} <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">br</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Two</span> <span style="color:#a6e22e">times</span> <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">input</span> <span style="color:#a6e22e">ng</span><span style="color:#f92672">-</span><span style="color:#a6e22e">model</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;num&#34;</span><span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">equals</span> {{ <span style="color:#66d9ef">double</span>(<span style="color:#a6e22e">num</span>) }}
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">/div&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">script</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">myApp</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">angular</span>.<span style="color:#a6e22e">module</span>(<span style="color:#e6db74">&#39;myApp&#39;</span>, []);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">myApp</span>.<span style="color:#a6e22e">controller</span>(<span style="color:#e6db74">&#39;GreetingController&#39;</span>, [<span style="color:#e6db74">&#39;$scope&#39;</span>, <span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">$scope</span>) {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">$scope</span>.<span style="color:#a6e22e">greeting</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;Hola!&#39;</span>;
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">$scope</span>.<span style="color:#66d9ef">double</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">value</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">value</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">2</span>;
</span></span><span style="display:flex;"><span>      };
</span></span><span style="display:flex;"><span>    }]);
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">/script&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">/body&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">/html&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In this example, I&rsquo;ve implemented a <code>GreetingController</code> that receives the <code>$scope</code> object as a parameter. Within this controller, I define a <code>greeting</code> variable and a <code>double()</code> function, both attached to the scope as <code>$scope.greeting</code> and <code>$scope.double</code> respectively. These elements are then accessible in the template through the double curly braces syntax.</p>
<p>The successful resolution of <code>{{greeting}}</code> occurs because the variable exists within the <code>$scope</code>. Conversely, attempting to use <code>{{alert(1)}}</code> would fail since the <code>alert</code> function isn&rsquo;t defined in the scope. This mechanism forms the foundation of AngularJS&rsquo;s sandboxing approach.</p>
<h1 id="sandbox-escaping-mechanisms">Sandbox Escaping Mechanisms</h1>
<p>AngularJS implements various security measures, including the <code>ensureSafeObject</code> and <code>ensureSafeFunction</code> validations, which collectively form its sandboxing mechanism. However, different versions of AngularJS have distinct sandbox escaping mechanisms, as detailed in the <a href="https://portswigger.net/research/xss-without-html-client-side-template-injection-with-angularjs">PortSwigger research</a>.</p>
<p>Let&rsquo;s examine a payload that works across all AngularJS versions below 1.6, discovered by Mario Heiderich.</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:1;-o-tab-size:1;tab-size:1;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:1;-o-tab-size:1;tab-size:1;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:1;-o-tab-size:1;tab-size:1;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">constructor</span>.<span style="color:#a6e22e">constructor</span>(<span style="color:#e6db74">&#34;alert(1)&#34;</span>)();
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>In general, any variable or function used in interpolation {{variable}} will get resolved as $scope.variable. As $scope is a JavaScript object, I can chain constructor to it. So, if <code>{{constructor}}</code> was written, it gets resolved to $scope.constructor. Anything passed to this JavaScript constructor will create an anonymous function with the contents that are passed to the constructor as an argument in JavaScript, as shown in the image below.</p>
<img src="https://yashwanth164.github.io/blog.v3loz1ty/img/csti2.png" width="700" height="700" alt="Alt text" class="rounded-image">
<p>I created the function containing the payload that I want to execute, so to invoke it I append braces &lsquo;()&rsquo; as shown in the image below.</p>
<img src="https://yashwanth164.github.io/blog.v3loz1ty/img/csti3.png" width="700" height="700" alt="Alt text" class="rounded-image">
<p>This payload, while simple, effectively bypasses security measures in AngularJS versions &gt;= 1.6.0.</p>
<p>Gareth Heyes explored additional payloads that focus on manipulating native JavaScript functions through Angular expressions. Consider this example.</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:1;-o-tab-size:1;tab-size:1;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:1;-o-tab-size:1;tab-size:1;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:1;-o-tab-size:1;tab-size:1;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#e6db74">&#34;a&#34;</span>.<span style="color:#a6e22e">constructor</span>.<span style="color:#a6e22e">fromCharCode</span> <span style="color:#f92672">=</span> [].<span style="color:#a6e22e">join</span>;
</span></span></code></pre></td></tr></table>
</div>
</div><p>This payload replaces <code>String.fromCharCode</code> with <code>Array.prototype.join</code>, effectively hijacking the function&rsquo;s behavior. Subsequent calls to <code>String.fromCharCode</code> will execute <code>[].join</code> instead, breaking the expected functionality. The image below demonstrates the contrast between the normal <code>fromCharCode</code> behavior and its overwritten state using <code>[].join</code>, which returns an empty string:</p>
<img src="https://yashwanth164.github.io/blog.v3loz1ty/img/csti4.png" width="700" height="700" alt="Alt text" class="rounded-image">
<p>In Angular 2, <code>$scope</code> was completely removed to avoid these kinds of vulnerabilities. So sandbox-escaping techniques that targeted AngularJS no longer work in Angular 2 and later versions.</p>
<p>Hope you got the idea, Happy Hacking!</p>

    </div>
  </article>

  
  






  <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="https://yashwanth164.github.io/blog.v3loz1ty/">Home</a></li>
         
          <li><a href="https://yashwanth164.github.io/blog.v3loz1ty/posts">All posts</a></li>
         
          <li><a href="https://yashwanth164.github.io/blog.v3loz1ty/about">About</a></li>
        
      </ul>
    </div>

    
    <div id="toc-footer" style="display: none">
      <nav id="TableOfContents">
  <ul>
    <li><a href="#introduction">Introduction</a></li>
    <li><a href="#understanding-the-scope-object">Understanding the $scope Object</a></li>
    <li><a href="#sandbox-escaping-mechanisms">Sandbox Escaping Mechanisms</a></li>
  </ul>
</nav>
    </div>
    

    <div id="share-footer" style="display: none">
      
      <ul>
  
  
    
  
  
  <li>
    <a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fyashwanth164.github.io%2fblog.v3loz1ty%2fposts%2fclientside_template_injection%2f" aria-label="Facebook">
      <i class="fab fa-facebook fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://twitter.com/share?url=https%3a%2f%2fyashwanth164.github.io%2fblog.v3loz1ty%2fposts%2fclientside_template_injection%2f&text=Client%20Side%20Template%20Injection%20%28CSTI%29" aria-label="Twitter">
      <i class="fab fa-twitter fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fyashwanth164.github.io%2fblog.v3loz1ty%2fposts%2fclientside_template_injection%2f&title=Client%20Side%20Template%20Injection%20%28CSTI%29" aria-label="Linkedin">
      <i class="fab fa-linkedin fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fyashwanth164.github.io%2fblog.v3loz1ty%2fposts%2fclientside_template_injection%2f&is_video=false&description=Client%20Side%20Template%20Injection%20%28CSTI%29" aria-label="Pinterest">
      <i class="fab fa-pinterest fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="mailto:?subject=Client%20Side%20Template%20Injection%20%28CSTI%29&body=Check out this article: https%3a%2f%2fyashwanth164.github.io%2fblog.v3loz1ty%2fposts%2fclientside_template_injection%2f" aria-label="Email">
      <i class="fas fa-envelope fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2fyashwanth164.github.io%2fblog.v3loz1ty%2fposts%2fclientside_template_injection%2f&title=Client%20Side%20Template%20Injection%20%28CSTI%29" aria-label="Pocket">
      <i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2fyashwanth164.github.io%2fblog.v3loz1ty%2fposts%2fclientside_template_injection%2f&title=Client%20Side%20Template%20Injection%20%28CSTI%29" aria-label="reddit">
      <i class="fab fa-reddit fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.tumblr.com/share/link?url=https%3a%2f%2fyashwanth164.github.io%2fblog.v3loz1ty%2fposts%2fclientside_template_injection%2f&name=Client%20Side%20Template%20Injection%20%28CSTI%29&description=%3ch1%20id%3d%22introduction%22%3eIntroduction%3c%2fh1%3e%0a%3cp%3eTemplate%20injection%20is%20a%20critical%20web%20security%20vulnerability%20that%20occurs%20when%20user%20input%20is%20embedded%20into%20a%20template%20in%20an%20unsafe%20manner.%20This%20vulnerability%20allows%20attackers%20to%20inject%20malicious%20template%20code%20that%20can%20lead%20to%20remote%20code%20execution%2c%20data%20theft%2c%20or%20server%20compromise.%20Template%20injection%20can%20occur%20on%20both%20client-side%20and%20server-side.%20This%20blog%20focuses%20on%20client-side%20template%20injection%20in%20AngularJS%20framework%20which%20leads%20to%20XSS%20attacks.%3c%2fp%3e%0a%3cp%3eDeveloped%20by%20Google%2c%20AngularJS%20serves%20as%20a%20powerful%20frontend%20framework%20for%20building%20dynamic%20web%20applications.%20The%20framework%26rsquo%3bs%20template%20injection%20vulnerability%20has%20gained%20significant%20attention%20in%20the%20security%20community%2c%20particularly%20due%20to%20the%20groundbreaking%20sandbox%20escape%20techniques%20discovered%20by%20%3ca%20href%3d%22https%3a%2f%2fx.com%2fgarethheyes%22%3eGareth%20Heyes%3c%2fa%3e%20and%20Mario%20Heiderich%20from%20Cure53.%20For%20a%20deeper%20dive%20into%20their%20research%20on%20AngularJS%20sandbox%20escaping%2c%20refer%20to%20this%20comprehensive%20%3ca%20href%3d%22https%3a%2f%2fportswigger.net%2fresearch%2fxss-without-html-client-side-template-injection-with-angularjs%22%3ePortSwigger%20blog%3c%2fa%3e.%3c%2fp%3e" aria-label="Tumblr">
      <i class="fab fa-tumblr fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fyashwanth164.github.io%2fblog.v3loz1ty%2fposts%2fclientside_template_injection%2f&t=Client%20Side%20Template%20Injection%20%28CSTI%29" aria-label="Hacker News">
      <i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i>
    </a>
  </li>
</ul>

    </div>

    <div id="actions-footer">
      
        <a id="menu-toggle" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;" aria-label="Menu">
          <i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
        <a id="toc-toggle" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;" aria-label="TOC">
          <i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        
        <a id="share-toggle" class="icon" href="#" onclick="$('#share-footer').toggle();return false;" aria-label="Share">
          <i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" aria-label="Top of Page">
          <i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>


  <footer id="footer">
  <div class="footer-left">
    Copyright  &copy; 2025  v3loz1ty 
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
        <li><a href="https://yashwanth164.github.io/blog.v3loz1ty/">Home</a></li>
         
        <li><a href="https://yashwanth164.github.io/blog.v3loz1ty/posts">All posts</a></li>
         
        <li><a href="https://yashwanth164.github.io/blog.v3loz1ty/about">About</a></li>
        
      </ul>
    </nav>
  </div>
</footer>


  </div>
</body>

<link rel="stylesheet" href=https://yashwanth164.github.io/blog.v3loz1ty/lib/font-awesome/css/all.min.css>
<script src=https://yashwanth164.github.io/blog.v3loz1ty/lib/jquery/jquery.min.js></script>
<script src=https://yashwanth164.github.io/blog.v3loz1ty/js/main.js></script>

<script src=https://yashwanth164.github.io/blog.v3loz1ty/js/code-copy.js></script>




</html>
